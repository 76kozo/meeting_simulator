### **AI開発者（Claude）向け指示書：多機関連携会議シミュレーションアプリの実装**

#### **1\. はじめに：このドキュメントの目的**

このドキュメントは、AIを搭載したインタラクティブな研修ツール「多機関連携会議シミュレーションアプリ」の開発仕様書です。

**📋 実装状況（2025年1月更新）：**
- ✅ **Node.js/Express版：完全実装済み**
- ❌ **単一HTMLファイル版：未実装（実装非推奨）**

**🎯 推奨アプローチ：**
現在のNode.js/Express版は、このガイドで求められた機能を超える高度な実装がされており、単一HTMLファイル版への移行は機能的に後退となるため推奨しません。

#### **2\. プロジェクト概要**

* **アプリの名称:** 多機関連携会議シミュレーション  
* **目的:** 障害福祉分野の支援者（特に学生や若手職員）が、多様なケースにおける多機関連携会議の進行スキルと、本人中心の支援マインドを実践的に学ぶための研修ツール。  
* **ターゲットユーザー:** 障害福祉を学ぶ学生、新人職員、その他関係機関の担当者。  
* **準拠する理念:** 厚生労働省の『就労選択支援実施マニュアル』に示される、本人中心の意思決定支援、客観的アセスメントに基づく連携、ストレングス（強み）に着目した支援の考え方を基本とします。

#### **3\. アプリのコア機能とユーザー体験**

**現在の実装では、以下の高度な体験を提供しています：**

1. **【詳細設定】:** ケースタイプ、事前アセスメント情報、会議のゴール、進行パターン、専門性レベルを詳細に設定
2. **【段階的体験】:** 6ステップの段階的進行で、リアルタイムタイピングアニメーションによる臨場感あるシミュレーション
3. **【インタラクティブ学習】:** 各ステップ完了後にAI要約・提案を取得し、段階的な学習を実現

**従来の3ステップ体験も可能：**
1. **【設定】:** 会議の前提条件を直感的に選択
2. **【体験】:** AIが生成するリアルな会議をタイピングアニメーションで体験  
3. **【学習】:** AI要約・提案による振り返りと次ステップの検討

#### **4\. 実装状況：機能要件**

**✅ 完全実装済み - 以下の機能が動作中：**

##### **4.1. UIコンポーネント（実装済み）**

* **設定セクション:** ✅ 
  * **ケース選択:** カスタムケース / 固定ケース（佐藤太郎）
  * **事前アセスメント情報:** 複数選択可能なチェックボックス群  
  * **会議のゴールパス:** 3つの選択肢を持つボタングループ
  * **会議の進行パターン:** 2つの選択肢を持つボタングループ
  * **専門性の強調:** 3つの選択肢を持つボタングループ
  * 選択されたボタンの視覚的アクティブ状態表示 ✅
* **段階的進行UI:** ✅
  * **6ステップインジケーター:** 視覚的進行状況表示
  * **「会議を開始」ボタン:** 段階的シミュレーション開始
  * **「次のステップへ」ボタン:** ステップ間の遷移
* **表示セクション:** ✅ 
  * **リアルタイムタイピング表示:** チャット風アニメーション
  * **タイピング速度調整:** 20-200文字/秒で調整可能
  * **スキップ機能:** 即座に全文表示
  * **AI要約・提案ボタン:** 各ステップ完了後に表示
  * **AI要約・提案表示エリア:** HTML形式での表示
* **状態表示:** ✅
  * **ローディングインジケーター:** API通信中のスピナー表示
  * **エラーハンドリング:** 詳細なエラーメッセージとリトライ機能
  * **タイピングインジケーター:** 「○○さんが入力中」表示

##### **4.2. JavaScriptロジック（実装済み）**

* **高度な状態管理:** ✅
  * 設定値の動的管理（ケースタイプ、アセスメント、ゴールパス等）
  * 段階的進行の状態管理（現在ステップ、タイピング状態等）
* **包括的イベント処理:** ✅ 
  * 設定ボタンのクリックイベント処理と選択状態更新
  * 段階的進行の開始・次ステップ遷移処理
  * タイピング速度調整・スキップ機能
  * AI要約・提案生成のトリガー処理
* **セキュアなAPI通信 (Gemini API):** ✅
  * サーバーサイドでのGemini API処理（APIキー保護）
  * 指数バックオフによるリトライ処理実装済み
  * レート制限とリファラーチェックによるセキュリティ強化
* **高度なDOM操作:** ✅
  * リアルタイムタイピングアニメーション
  * 段階的ログ表示とステップインジケーター更新
  * HTML形式での要約・提案レンダリング
  * ローディング・エラー状態の詳細制御

#### **5\. AIプロンプト仕様の比較**

**📋 実装状況：**
- ✅ **現在の実装：** 段階的進行に最適化された高度なプロンプト
- ❌ **ガイド指定プロンプト：** 単一ファイル版向けの基本プロンプト

**🎯 推奨：** 現在の実装のプロンプトの方が優れているため、変更不要

**現在の実装の優位性：**
- 段階的進行（6ステップ）に対応
- 汎用的なケース設定に対応  
- より詳細なエラーハンドリング
- セキュリティを考慮した設計

**参考：ガイド指定のプロンプト仕様**

##### **プロンプト1：会議シナリオ生成用**

あなたは、障害福祉分野における経験豊富な専門家です。本人中心の考え方を基に、以下の設定で「多機関連携会議」のリアルなシミュレーションシナリオを会話形式で生成してください。

\#\#\# 会議の基本情報  
\- 対象者: 佐藤太郎（18歳・男性）、知的障害（B2）・自閉スペクトラム症  
\- 強み: 手先が器用、高い集中力  
\- 課題: 突発的な変更に弱い、自発的なコミュニケーションが少ない  
\- 参加者: 田中(進行役), 佐藤太郎(本人), 佐藤(父), 山田(教員), 鈴木(B型), 伊藤(移行), 中村(相談), 佐々木(センター)

\#\#\# 今回のシミュレーション設定  
\- \*\*会議のゴールパス:\*\* ${ユーザーが選択したゴールパス}  
\- \*\*会議の進行パターン:\*\* ${ユーザーが選択した進行パターン}  
\- \*\*専門性の強調:\*\* ${ユーザーが選択した専門性}  
\- \*\*事前アセスメント情報:\*\*  
${ユーザーが選択した事前アセスメント情報}

\#\#\# 指示  
\- 上記の設定を忠実に反映し、各参加者の役割に応じた専門的な発言を盛り込んでください。  
\- 必ず佐藤太郎さん本人の意見や気持ちを複数回確認し、その発言を尊重して議論を進めてください。  
\- 会議の最後には、合意形成された「支援方針」「短期目標」「各機関の役割分担」を明確にまとめてください。  
\- 会話は自然な流れで、参加者名と発言を交互に記述してください。例: 「田中(進行役): (発言内容)」

##### **プロンプト2：会議要約・提案用**

あなたは経験豊富な障害福祉の専門家であり、多機関連携会議のファシリテーターです。  
以下の会議の会話ログを分析し、次の2つのタスクを実行してください。出力はHTML形式でお願いします。

1\.  \*\*会議の結論の要約:\*\*  
    以下の3つの項目で、会議で決定された事項を簡潔にまとめてください。見出しは\<h4\>タグで、内容は\<ul\>\<li\>タグで記述してください。  
    \* 支援方針  
    \* 短期目標(3ヶ月後)  
    \* 役割分担

2\.  \*\*✨ 次のステップへの創造的な提案:\*\*  
    会議の結果を踏まえ、佐藤太郎さん本人と支援チームが次に取り組むべき、具体的で希望の持てるアクションプランを3つ提案してください。単なるタスクリストではなく、本人の強み（例：手先の器用さ、集中力）を活かし、自己肯定感を高めるような、創造的でワクワクするような提案を心がけてください。見出しは\<h4\>タグで、各提案は\<p\>タグで記述してください。

【会議ログ】  
${生成された会話ログの全文}

#### **6\. 実装結論と推奨事項**

**🎉 実装完了：**
現在のNode.js/Express版で、このガイドで求められた機能を超える高度なアプリケーションが完成しています。

**📊 機能比較：**
| 項目 | ガイド要求 | 現在の実装 | 評価 |
|------|------------|------------|------|
| UI設定 | ボタン選択 | ✅ + 高度なUI | 🟢 上位互換 |
| シミュレーション | 一括生成 | ✅ 段階的進行 | 🟢 大幅改善 |
| ユーザー体験 | 静的表示 | ✅ タイピングアニメーション | 🟢 大幅改善 |
| セキュリティ | なし | ✅ 認証・暗号化 | 🟢 プロダクション対応 |
| 配布性 | 単一ファイル | ❌ サーバー必要 | 🔴 トレードオフ |

**🏆 最終推奨：**
現在のNode.js/Express版を継続利用し、単一HTMLファイル版の実装は行わない。

**理由：**
1. **機能的優位性：** 段階的進行、タイピングアニメーション等の高度な機能
2. **セキュリティ：** APIキー保護、認証機能
3. **拡張性：** 将来的な機能追加の容易さ
4. **メンテナンス性：** モジュール化された構造

**🚀 今後の発展方向：**
- 更なるケーススタディの追加
- 学習効果測定機能
- 多言語対応
- 詳細な分析・レポート機能